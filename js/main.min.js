!function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s(s.s=0)}([function(e,t,s){"use strict";s(1),s(3)},function(e,t,s){"use strict";s(2)},function(e,t,s){"use strict";function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const n="0123456789";!function(){try{localStorage.setItem("check","cheked")}catch(e){e==e.QUOTA_EXCEEDED_ERR&&alert("Limit is exceeded")}}();const c=new class{constructor(){this._$gallery=document.querySelector(".gallery")}get $gallery(){return this._$gallery}onWheel(e){e.preventDefault(),this.scrollBy(-e.wheelDelta,0),window.scrollBy(-e.wheelDelta,0)}};class l{constructor(){this.id=0,this.imgsrc="",this.likes=[],this.dislikes=[],this.comments=[]}addDataClass(){const e=[...document.querySelectorAll(".thumb")];new Promise(()=>{let t=0;for(let s=0;s<e.length;s++){t++,e[s].setAttribute("data-class",t),t>8&&(t=0)}}).then(l.addThumbType(e))}static addThumbType(e){e.forEach(e=>{const t=e.getAttribute("data-class");switch(!0){case"1"===t||"5"===t:e.classList.add("thumb_type1");break;case"2"===t||"3"===t||"4"===t||"7"===t||"8"===t||"9"===t:e.classList.add("thumb_type2");break;case"6"===t:e.classList.add("thumb_type3");break;default:e.classList.add("thumb_type2")}})}}const a=new l;const o=new class{constructor(){this.$popup=document.querySelector(".search-img"),this.$closeEl=document.querySelector(".search-close"),this.openClass="search-open",this.$search=document.querySelector("#imgText"),this.$searchBtn=document.querySelector("#searchBtn")}openSearch(){this.$popup.classList.add(this.openClass),document.querySelector("body").classList.add("noscroll")}closePopup(){this.$popup.classList.remove(this.openClass),document.querySelector("body").classList.remove("noscroll")}getSearchText(e){e.preventDefault;let t=this.$search;if(""!==t.value.trim()&&-1==t.value.trim().search(/\s\S/)){let e,s=t.value.trim();fetch(`https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=1742fab55ce3aa5c9734adcc374aeb5a&text=${s}&sort=relevance&privacy_filter=1&safe_search=1&per_page=1&page=1&format=json&nojsoncallback=1`).then(e=>e.json()).then(t=>{const s=t.photos.photo[0];e=s.id,a.imgsrc=`https://farm${s.farm}.staticflickr.com/${s.server}/${s.id}_${s.secret}.jpg`,a.id=s.id,localStorage.setItem(a.id,JSON.stringify(a)),this.closePopup(),r.createImg(e)})}}};o.$closeEl.addEventListener("click",o.closePopup.bind(o)),o.$searchBtn.addEventListener("click",o.getSearchText.bind(o)),o.$search.addEventListener("keypress",(function(e){13==e.keyCode&&o.$searchBtn.click()}));class r{constructor(e){this._wrap=e,this._$formThumb=document.querySelector(".thumb-form"),this._$formBtn=document.querySelector("#load-img")}get $formThumb(){return this._$formThumb}get wrap(){return this._wrap}get $formBtn(){return this._$formBtn}getImgFile(e){e.preventDefault,o.openSearch()}static createImg(e){let t=e;new Promise(()=>{const e=u().find(e=>e.id==t),s=e.comments.length,i=e.dislikes.length,n=e.likes.length;d.$formThumb.insertAdjacentHTML("beforebegin",`<figure class="thumb" data-id=${e.id}>\n                    <img src=${e.imgsrc}  data-id=${e.id} alt="forest">\n                    <figcaption class="thumb__info">\n                        <div class="info-item info-item_left">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24"><path fill="#a0b0ba" d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM9 11H7V9h2v2zm4 0h-2V9h2v2zm4 0h-2V9h2v2z"/>\n                            <path d="M0 0h24v24H0z" fill="transparent"/></svg>\n                            <span class="comments__counter count" data-comments=${e.id}>${s}</span>\n                        </div>\n                        <div class="info-item">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24"><path fill="transparent" d="M0 0h24v24H0z"/>\n                            <path fill="#a0b0ba" d="M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z"/></svg>\n                            <span class="dislike-counter count" data-dislikes=${e.id}>${i}</span>\n                        </div>\n                        <div class="info-item">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24"><path fill="transparent" d="M0 0h24v24H0V0z"/>\n                            <path fill="#a0b0ba" d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"/></svg>\n                            <span class="like_counter count" data-likes=${e.id}>${n}</span>\n                        </div>\n                    </figcaption>\n                </figure>`)}).then(c.$gallery.insertAdjacentElement("beforeend",d.$formThumb),a.addDataClass())}}const d=new r(c.$gallery);function u(){const e=[];for(let t=0;t<localStorage.length;t++){let s=localStorage.key(t),i=localStorage.getItem(s);Number.isInteger(+s)&&e.push(JSON.parse(i))}return e.sort((function(e,t){return e.id-t.id})),e}d.$formBtn.addEventListener("click",d.getImgFile),c.$gallery.addEventListener("mousewheel",c.onWheel,{passive:!1}),function(e){let t,s,i,n;new Promise(()=>{const c=e;for(let e=0;e<c.length;e++)t=c[e],s=t.comments.length,i=t.dislikes.length,n=t.likes.length,d.$formThumb.insertAdjacentHTML("beforebegin",`<figure class="thumb"  data-id=${t.id}>\n                    <img src=${t.imgsrc} data-id=${t.id} alt="forest">\n                    <figcaption class="thumb__info">\n                        <div class="info-item info-item_left">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24"><path fill="#a0b0ba" d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM9 11H7V9h2v2zm4 0h-2V9h2v2zm4 0h-2V9h2v2z"/>\n                            <path d="M0 0h24v24H0z" fill="transparent"/></svg>\n                            <span class="comments__counter count" data-comments=${t.id}>${s}</span>\n                        </div>\n                        <div class="info-item">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24"><path fill="transparent" d="M0 0h24v24H0z"/>\n                            <path fill="#a0b0ba" d="M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z"/></svg>\n                            <span class="dislike-counter count" data-dislikes=${t.id}>${i}</span>\n                        </div>\n                        <div class="info-item">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24"><path fill="transparent" d="M0 0h24v24H0V0z"/>\n                            <path fill="#a0b0ba" d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"/></svg>\n                            <span class="like_counter count" data-likes=${t.id}>${n}</span>\n                        </div>\n                    </figcaption>\n                </figure>`)}).then(d.wrap.insertAdjacentElement("beforeend",d.$formThumb),a.addDataClass())}(u());class m{static setId(e){this._id=e}static getId(){return this._id}constructor(e){this.wrap=e,this._id=null}closePopup(){m.popupClose.onclick=()=>{m.popup.classList.remove("open-popup"),document.querySelector("body").classList.remove("noscroll"),m.setId(null),document.querySelector(".block-img").remove(),document.querySelector(".comments").remove()}}openPopup(){this.wrap.onclick=function(e){const t=e.target;t&&t.closest(".thumb")&&Promise.all([m.popup.classList.add("open-popup"),document.querySelector("body").classList.add("noscroll"),m.setId(t.closest(".thumb").getAttribute("data-id")),m.createPopupImg()]).then(g.setLikeId.apply(m.getId),p.setDislikeId.apply(m.getId),f.setCommElements.apply(m.getId),f.createComment())}}static createPopupImg(){const e=u();for(let t=0;t<e.length;t++){const s=e[t],i=s.comments.length,n=s.dislikes.length,c=s.likes.length;if(s.id==m.getId()&&null!=m.getId()){document.querySelector(".popup__content").insertAdjacentHTML("beforeend",`<figure class="block-img">\n                        <img src=${s.imgsrc} alt="forest">\n                        <figcaption class="block-img__info">\n                            <div class="block-img__info-item dislike ${p.toggleActive(s.dislikes)}" data-dis="">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24"><path fill="transparent" d="M0 0h24v24H0z"/>\n                                <path fill="#a0b0ba" d="M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z"/></svg>\n                                <span class="dislike_counter count" data-dislikes=${s.id}>${n}</span></div>\n                            <div class="block-img__info-item like ${g.toggleActive(s.likes)}" data-like="">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24"><path fill="transparent" d="M0 0h24v24H0V0z"/>\n                                <path fill="#a0b0ba" d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"/></svg>\n                                <span class="like_counter count" data-likes=${s.id}>${c}</span></div>\n                        </figcaption>\n                    </figure>\n                    <article class="comments">\n                        <h2 class="comments__heading">COMMENTS: <span class="comments__counter" data-comments=${s.id}>${i}</span></h2>\n                        <section class="comments__window">\n                            <ul id="messages-list">\n                                \n                            </ul>\n                        </section>\n                        <form class="message-form" onsubmit="return false"> \n                            <input id="name" type="text" placeholder="Type your nickname here...">\n                            <p class="message-wrap">\n                                <textarea id="message" placeholder="Write your comment here..."></textarea>\n                                <button id="message-btn" type="button">\n                                    <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24"><path fill="transparent" d="M0 0h24v24H0V0z"/>\n                                    <path fill="#ffffff" d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-6.54 4.09c-.65.41-1.47.41-2.12 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z"/></svg>\n                                </button>\n                            </p>\n                        </form>\n                    </article>`);const e=document.querySelector(".like"),t=document.querySelectorAll("[data-likes]"),l=document.querySelector(".dislike"),a=document.querySelectorAll("[data-dislikes]"),o=document.querySelector("#messages-list"),r=document.querySelectorAll(".comments__counter"),d=e=>{e.forEach(e=>{switch(e.type){case"attributes":for(let e=0;e<a.length;e++){const t=a[e];t.getAttribute("data-dislikes")==m.getId()&&(t.textContent=y())}}})},h=e=>{e.forEach(e=>{switch(e.type){case"childList":for(let e=0;e<r.length;e++){const t=r[e];t.getAttribute("data-comments")===m.getId()&&(t.textContent=w())}}})},f=new MutationObserver(e=>{e.forEach(e=>{switch(e.type){case"attributes":for(let e=0;e<t.length;e++){const s=t[e];s.getAttribute("data-likes")==m.getId()&&(s.textContent=b())}}})}),v=new MutationObserver(d),k=new MutationObserver(h);f.observe(e,{attributes:!0,attributeFilter:["class","data-like"]}),v.observe(l,{attributes:!0,attributeFilter:["class","data-like"]}),k.observe(o,{childList:!0});const b=()=>{const e=u();for(let t=0;t<e.length;t++){const s=e[t],i=s.likes.length;if(s.id==m.getId()&&null!=m.getId())return i}},y=()=>{const e=u();for(let t=0;t<e.length;t++){const s=e[t],i=s.dislikes.length;if(s.id==m.getId()&&null!=m.getId())return i}},w=()=>{const e=u();for(let t=0;t<e.length;t++){const s=e[t],i=s.comments.length;if(s.id==m.getId()&&null!=m.getId())return i}}}}}}i(m,"popup",document.querySelector(".popup")),i(m,"popupClose",document.querySelector(".popup-close"));const h=new m(c.$gallery);h.openPopup(),h.closePopup();class g{constructor(){this.$like=document.querySelector(".like"),this.activeClass="like-active"}static setLikeId(){this.$like=document.querySelector(".like"),g.clickLike.apply(this)}static toggleActive(e){return-1!==e.findIndex((function(e){return e.uniq===n}))?"like-active":""}static clickLike(){this.$like.onclick=function(e){e.preventDefault;const t=this,s=u();for(let e=0;e<s.length;e++){const i=s[e];if(i.id==m.getId()){const e=i.dislikes.findIndex((function(e){return e.uniq===n})),s=i.likes.findIndex((function(e){return e.uniq===n}));-1!==s||t.classList.contains("like-active")?(t.classList.remove("like-active"),t.setAttribute("data-like","false"),i.likes.splice(s,1),localStorage.setItem(i.id,JSON.stringify(i))):(t.classList.add("like-active"),t.setAttribute("data-like","true"),i.likes.push({uniq:n}),localStorage.setItem(i.id,JSON.stringify(i)),-1!==e&&document.querySelector(".dislike").classList.contains("dislike-active")&&(document.querySelector(".dislike").classList.remove("dislike-active"),t.setAttribute("data-dis","false"),i.dislikes.splice(e,1),localStorage.setItem(i.id,JSON.stringify(i))))}}}}}new g;class p{constructor(){this.$dislike=document.querySelector(".dislike"),this.activeClass="dislike-active"}static setDislikeId(){this.$dislike=document.querySelector(".dislike"),p.clickDislike.apply(this)}static toggleActive(e){return-1!==e.findIndex((function(e){return e.uniq===n}))?"dislike-active":""}static clickDislike(){this.$dislike.onclick=function(e){e.preventDefault;const t=this,s=u();for(let e=0;e<s.length;e++){const i=s[e];if(i.id==m.getId()){const e=i.dislikes.findIndex((function(e){return e.uniq===n})),s=i.likes.findIndex((function(e){return e.uniq===n}));-1!==e||t.classList.contains("dislike-active")?(t.classList.remove("dislike-active"),t.setAttribute("data-dis","false"),i.dislikes.splice(e,1),localStorage.setItem(i.id,JSON.stringify(i))):(t.classList.add("dislike-active"),t.setAttribute("data-dis","true"),i.dislikes.push({uniq:n}),localStorage.setItem(i.id,JSON.stringify(i)),-1!==s&&document.querySelector(".like").classList.contains("like-active")&&(document.querySelector(".like").classList.remove("like-active"),t.setAttribute("data-like","false"),i.likes.splice(e,1),localStorage.setItem(i.id,JSON.stringify(i))))}}}}}new p;class f{constructor(){this.$formBtn=document.querySelector("#message-btn")}static setCommElements(){f.$name=document.querySelector("#name"),f.$message=document.querySelector("#message"),f.$msgWindow=document.querySelector("#messages-list"),this.$formBtn=document.querySelector("#message-btn"),f.sendMsessage.apply(this)}static sendMsessage(){f.$message.onkeypress=e=>{13==e.keyCode&&this.$formBtn.click()},this.$formBtn.onclick=function(e){e.preventDefault;const t=f.$name.value,s=f.$message.value,i=new Date;if(""!==t.trim()&&""!==s.trim()){const e=u();for(let c=0;c<e.length;c++){const l=e[c];l.id==m.getId()&&new Promise(()=>{l.comments.push({uniq:n,name:t,date:i,message:s})}).then(localStorage.setItem(l.id,JSON.stringify(l))).then(f.createComment(),f.$name.value="",f.$message.value="",document.querySelector(".comments__window").scrollTop=document.querySelector(".comments__window").scrollHeight)}}}}static createComment(){const e=u();for(let t=0;t<e.length;t++){const s=e[t],i=s.comments;if(s.id==m.getId()){for(;f.$msgWindow.firstChild;)f.$msgWindow.firstChild.remove();for(let e=0;e<i.length;e++){const t=new Date(i[e].date),s=Date.now()-t,n=Math.floor(s/36e5);f.$msgWindow.insertAdjacentHTML("beforeend",`<li class="comment" data-time = ${Date.parse(i[e].date)}>\n                            <address class="comment__user">by ${i[e].name}</address>\n                            <time class="comment__date" datetime="${i[e].date}">${v.howOld(n)} ${v.pmam(t)}</time>\n                            <p class="comment__msg">${i[e].message}</p>\n                        </li>`)}}}}}i(f,"$name",void 0),i(f,"$message",void 0),i(f,"$msgWindow",void 0);new f;class v{static pmam(e){return e.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})}static howOld(e){const t=24;switch(!0){case e<t:return"Today";case t>e<48:return"Yesterday";case 48>e<72:return"2 Days ago";case 72>e<96:return"3 Days ago";case 96>e<120:return"4 Days ago";case 120>e<144:return"5 Days ago";case 144>e<168:return"6 Days ago";case 168>e<192:return"Week ago"}}}new v},function(e,t,s){}]);